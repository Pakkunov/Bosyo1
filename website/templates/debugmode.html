{% extends "main.html" %}

{% block title %}Profile Page{% endblock title %}
{% block content %}

{% include 'sidebar.html' %}

<style>
  body {
    font-family: 'Montserrat', sans-serif;
  }

  .colIMG {
    position: relative;
    text-align: center;
  }

  .servicesUnderline {
    background-image: linear-gradient(120deg, #84fab0, #4bb2e694);
    background-repeat: no-repeat;
    background-size: 100% .4em;
    background-position: 70% 100%;
    transition: background-size .25s ease-in;
    }

.servicesUnderline2 {
    background-image: linear-gradient(120deg, #84fab0, #4bb2e694);
    background-repeat: no-repeat;
    background-size: 100% 100%;
    background-position: 70% 100%;
    transition: background-size .25s ease-in;
    }

</style>

<body>
  
<section style="margin-left: 140px;">
<div class="container">
  <div class="row">
    <h1 class="fs-1 mb-1 pt-5">Payment</h1>
    <p class="mb-3">Fill in the required information to continue.</p>
      <!-- 1st Column -->
      <div class="col-md-4 colIMG mx-3 ms-4">
        <img
            src="\static\images\gradient_green.jpg"
            class="img-fluid my-3 mx-auto d-none d-md-block"
            style="width: 550px; height: 460px"
            alt="">
        <div class="d-block d-md-none xl-none mt-3">
          <h1 class="display-6" style="text-shadow: 1px #fff;">PHP {{user.outstanding_balance}}</h1>
      </div>
      </div>
      <!-- 2nd Column -->
      <div class="col-md-6 col-xs-6 ms-3">
        <div id="smart-button-container">
          {% csrf_token %}
          {% load humanize %}
            {% if user.outstanding_balance is none %}
          <p class="fw-bold">
            <span class="servicesUnderline">You have no outstanding balance.</span><br>
          </p>
          <p class="py-2">
            Logged in as: <span class="fw-bold">{{user.username}}</span>
          </p> 
          
          {% else %}
          <p class="mt-2 fw-bold d-none d-md-block">Amount to pay:
            <span class="servicesUnderline2">PHP {{ user.outstanding_balance|intcomma }}</span><br>
          </p>
          <p class="py-2">
            Logged in as: <span class="fw-bold">{{user.username}}</span>
          </p> 
          {% endif%}
          <form method="post">
            {% csrf_token %}
          <p class="mb-3 mt-3">Please confirm and enter your Username: <span class="text-danger">*</span></p>
          <div class="mb-2" style="text-align: start">
            <input style="padding-left: 10px; width: 600px; border-radius: 20px; color: black;" type="text" name="HOA" id="description" placeholder="Username" maxlength="127" value=""></div>
            <p id="descriptionError" style="visibility: hidden; color:red; text-align: start;">Please enter your name/HOA</p>
          <p class="mb-3 mt-2">Enter amount to pay in PHP:</p>
          <div class="mb-2" style="text-align: start"><input style="padding-left: 10px; width: 600px; border-radius: 20px; color: black;" name="Amount" placeholder="Amount in Peso" type="number" id="amount" value=""></div>
            <p class="mb-3" id="priceLabelError" style="visibility: hidden; color:red; text-align: start;">Please enter proper amount to pay</p>
          <div id="invoiceidDiv" style="text-align: start; display: none;"><label for="invoiceid"> </label><input name="invoiceid" maxlength="127" type="text" id="invoiceid" value="" ></div>
            <p id="invoiceidError" style="visibility: hidden; color:red; text-align: start;">Please enter an Invoice ID</p>
            <div style="text-align: center; width: 600px;" id="paypal-button-container"></div>
          </form>
        </div>
    </section>
    <!-- Include the PayPal JavaScript SDK -->
    <script src="https://www.paypal.com/sdk/js?client-id=AYUBK_5IUlIHcyY2I-3enRogGyAS1TjCEM-LXzv_14uu3DR8MQjszlryfC6Wv4Y5k9V1s9zGW6bxWVBi&currency=PHP"></script>

    <script>
        // Render the PayPal button into #paypal-button-container
        paypal.Buttons({
          style: {
            color: 'silver',
            shape: 'pill',
            label: 'paypal',
            layout: 'vertical',
            
            },

            // Set up the transaction
            createOrder: function(data, actions) {
                return actions.order.create({
                    purchase_units: [{
                        amount: {
                            value: '88.44'
                        }
                    }]
                });
            },

            // Finalize the transaction
            onApprove: function(data, actions) {
                return actions.order.capture().then(function(orderData) {
                    // Successful capture! For demo purposes:
                    console.log('Capture result', orderData, JSON.stringify(orderData, null, 2));
                    var transaction = orderData.purchase_units[0].payments.captures[0];
                    alert('Transaction '+ transaction.status + ': ' + transaction.id + '\n\nSee console for all available details');

                    // Replace the above to show a success message within this page, e.g.
                    // const element = document.getElementById('paypal-button-container');
                    // element.innerHTML = '';
                    // element.innerHTML = '<h3>Thank you for your payment!</h3>';
                    // Or go to another URL:  actions.redirect('thank_you.html');
                });
            }


        }).render('#paypal-button-container');
    </script>
</body>


</body>

{% endblock content %}